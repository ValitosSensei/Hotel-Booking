<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Hotel Booking</title>
    <link rel="stylesheet" href="/index.css"> <!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å—Ç–∏–ª—ñ–≤ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script>
        function toggleFilter() {
            const citySelect = document.querySelector("select[name='city']");
            const ratingFields = document.querySelectorAll(".rating-filter input, .rating-filter select");
            const ratingFilterDiv = document.querySelector(".rating-filter");

            // –Ø–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ "–£—Å—ñ –º—ñ—Å—Ç–∞", –≤–∏–º–∏–∫–∞—î–º–æ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é —Ç–∞ —Å–∫–∏–¥–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è
            if (citySelect.value === "") {
                ratingFields.forEach(field => field.disabled = true); // –î–µ–∞–∫—Ç–∏–≤—É—î–º–æ —Ñ—ñ–ª—å—Ç—Ä–∏
                // –°–∫–∏–¥–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä—É –∑–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–º
                document.querySelector("input[name='minRating']").value = "";
                document.querySelector("input[name='maxRating']").value = "";
                document.querySelector("select[name='sortOrder']").value = "desc"; // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
                ratingFilterDiv.style.display = "none"; // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —Ñ—ñ–ª—å—Ç—Ä–∏
            } else {
                ratingFields.forEach(field => field.disabled = false); // –ê–∫—Ç–∏–≤—É—î–º–æ —Ñ—ñ–ª—å—Ç—Ä–∏
                ratingFilterDiv.style.display = "block"; // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ—ñ–ª—å—Ç—Ä–∏
            }
        }
        function toggleMenu() {
            const nav = document.querySelector('nav ul');
            nav.classList.toggle('active');

            // –ó–∞–∫—Ä–∏–≤–∞—Ç–∏ –º–µ–Ω—é –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –Ω–∏–º
            document.addEventListener('click', (e) => {
                if (!e.target.closest('nav') && !e.target.closest('.menu-toggle')) {
                    nav.classList.remove('active');
                }
            });
        }

        // –í–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ç–∞ –ø—Ä–∏ –∑–º—ñ–Ω—ñ –º—ñ—Å—Ç–∞
        window.onload = toggleFilter;
    </script>
</head>
<body>

<div class="container">
    <header>
        <h1>Welcome to the Hotel Booking System</h1>
        <button class="menu-toggle" onclick="toggleMenu()">
            <i class="fas fa-bars"></i>
        </button>
        <nav>
            <ul>
                <li><a href="/register"><i class="fas fa-user-plus"></i>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a></li>
                <li><a href="/login"><i class="fas fa-sign-in-alt"></i>–í—Ö—ñ–¥</a></li>
                <li><a href="/profile"><i class="fas fa-user-circle"></i>–ü—Ä–æ—Ñ—ñ–ª—å</a></li>
                <li><a href="/create"><i class="fas fa-plus-circle"></i>–°—Ç–≤–æ—Ä–∏—Ç–∏</a></li>
                <li><a href="/admin"><i class="fas fa-lock"></i>–ê–¥–º—ñ–Ω–∫–∞</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <form method="get" th:action="@{/}">
            <div class="filter">
                <label>City:</label>
                <select name="city" th:onchange="this.form.submit(); toggleFilter();">
                    <option value="">All Cities</option>
                    <option th:each="city : ${cities}" th:value="${city}" th:text="${city}" th:selected="${selectedCity == city}"></option>
                </select>
            </div>

            <!-- –§–æ—Ä–º–∞ –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –∑–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–º, –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ –º—ñ—Å—Ç–æ -->
            <div class="rating-filter" style="display: none;">
                <label>Sort by Rating:</label>
                <select name="sortOrder" onchange="this.form.submit()">
                    <option value="desc" th:selected="${sortOrder == 'desc'}">Highest to Lowest</option>
                    <option value="asc" th:selected="${sortOrder == 'asc'}">Lowest to Highest</option>
                </select>

                <div>
                    <label>Minimum Rating:</label>
                    <input type="number" step="0.1" name="minRating" th:value="${minRating}" placeholder="Enter minimum rating" />
                </div>
                <div>
                    <label>Maximum Rating:</label>
                    <input type="number" step="0.1" name="maxRating" th:value="${maxRating}" placeholder="Enter maximum rating" />
                </div>
            </div>

            <div class="filter-button-container">
                <button type="submit">üîç –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏</button>
            </div>
        </form>

        <section>
            <h2>List of Hotels</h2>
            <div class="hotels-list">
                <table>
                    <thead>
                    <tr>
                        <th>Hotel Name</th>
                        <th>Address</th>
                        <th>City</th>
                        <th>Country</th>
                        <th>Contact Info</th>
                        <th>Rooms</th>
                        <th>Rating</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="hotel : ${hotels}">
                        <td th:text="${hotel.name}"></td>
                        <td th:text="${hotel.address}"></td>
                        <td th:text="${hotel.city}"></td>
                        <td th:text="${hotel.country}"></td>
                        <td th:text="${hotel.contactInfo}"></td>
                        <td>
                                    <span th:with="rating=${hotel.averageRating}">
                                        <span th:each="i : ${#numbers.sequence(1, 5)}"
                                              th:classappend="${i <= rating} ? 'fa fa-star checked' : 'fa fa-star'"></span>
                                        <span th:text="'(' + ${#numbers.formatDecimal(rating, 1, 1)} + ')'"></span>
                                    </span>
                        </td>
                        <td><a th:href="@{/{hotelId}/rooms(hotelId=${hotel.id})}">View Rooms</a></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Hotel Booking System</p>
    </footer>
</div>
</body>
</html>
